)
highlight<-spc_data_f1 %>%
ungroup() %>%
mutate(is_between=between(xbar,dQ5_xbar$LCL,dQ5_xbar$UCL),
slide_above_below=case_when(
xbar>=mean_observed ~ 1,
xbar<mean_observed ~ -1
),
moving_ten_sum= abs(slide_sum(x = slide_above_below,  before = 10L, step=1L)),
highlight_true=if_else(moving_ten_sum>10, TRUE, FALSE)) %>%
highlight_outlier= case_when(
highlight_true=TRUE ~ "blue",
xbar=!between(xbar, dQ5_xbar$LCL, dQ5_xbar$UCL) ~ "blue",
xbar=between(xbar, dQ5_xbar$LCL, dQ5_xbar$UCL)~ "black"
)
highlight<-spc_data_f1 %>%
ungroup() %>%
mutate(is_between=between(xbar,dQ5_xbar$LCL,dQ5_xbar$UCL),
slide_above_below=case_when(
xbar>=mean_observed ~ 1,
xbar<mean_observed ~ -1
),
moving_ten_sum= abs(slide_sum(x = slide_above_below,  before = 10L, step=1L)),
highlight_true=if_else(moving_ten_sum>10, TRUE, FALSE)) %>%
colour= case_when(
highlight_true==TRUE ~ blue,
xbar=!between(xbar, dQ5_xbar$LCL, dQ5_xbar$UCL) ~blue,
xbar=between(xbar, dQ5_xbar$LCL, dQ5_xbar$UCL)~ black
)
spc_data_f1 %>%
ungroup() %>%
mutate(is_between=between(xbar,dQ5_xbar$LCL,dQ5_xbar$UCL),
slide_above_below=case_when(
xbar>=mean_observed ~ 1,
xbar<mean_observed ~ -1
),
moving_ten_sum= abs(slide_sum(x = slide_above_below,  before = 10L, step=1L)),
highlight_true=if_else(moving_ten_sum>10, TRUE, FALSE))
highlight<-spc_data_f1 %>%
ungroup() %>%
mutate(is_between=between(xbar,dQ5_xbar$LCL,dQ5_xbar$UCL),
slide_above_below=case_when(
xbar>=mean_observed ~ 1,
xbar<mean_observed ~ -1
),
moving_ten_sum= abs(slide_sum(x = slide_above_below,  before = 10L, step=1L)),
highlight_true=if_else(moving_ten_sum>10, TRUE, FALSE)) %>%
colour= case_when(
highlight_true==TRUE ~ blue,
xbar=!between(xbar, dQ5_xbar$LCL, dQ5_xbar$UCL) ~blue,
xbar=between(xbar, dQ5_xbar$LCL, dQ5_xbar$UCL)~ black
)
highlight<-spc_data_f1 %>%
ungroup() %>%
mutate(is_between=between(xbar,dQ5_xbar$LCL,dQ5_xbar$UCL),
slide_above_below=case_when(
xbar>=mean_observed ~ 1,
xbar<mean_observed ~ -1
),
moving_ten_sum= abs(slide_sum(x = slide_above_below,  before = 10L, step=1L)),
highlight_true=if_else(moving_ten_sum>10, TRUE, FALSE)),
highlight<-spc_data_f1 %>%
ungroup() %>%
mutate(is_between=between(xbar,dQ5_xbar$LCL,dQ5_xbar$UCL),
slide_above_below=case_when(
xbar>=mean_observed ~ 1,
xbar<mean_observed ~ -1
),
moving_ten_sum= abs(slide_sum(x = slide_above_below,  before = 10L, step=1L)),
highlight_true=if_else(moving_ten_sum>10, TRUE, FALSE),
colour= case_when(
highlight_true==TRUE ~ blue,
xbar=!between(xbar, dQ5_xbar$LCL, dQ5_xbar$UCL) ~ blue,
xbar=between(xbar, dQ5_xbar$LCL, dQ5_xbar$UCL) ~ black
))
highlight<-spc_data_f1 %>%
ungroup() %>%
mutate(is_between=between(xbar,dQ5_xbar$LCL,dQ5_xbar$UCL),
slide_above_below=case_when(
xbar>=mean_observed ~ 1,
xbar<mean_observed ~ -1
),
moving_ten_sum= abs(slide_sum(x = slide_above_below,  before = 10L, step=1L)),
highlight_true=if_else(moving_ten_sum>10, TRUE, FALSE),
colour= case_when(
highlight_true==TRUE ~ 'blue',
xbar=!between(xbar, dQ5_xbar$LCL, dQ5_xbar$UCL) ~ 'blue',
xbar=between(xbar, dQ5_xbar$LCL, dQ5_xbar$UCL) ~ 'black'
))
highlight<-spc_data_f1 %>%
ungroup() %>%
mutate(is_between=between(xbar,dQ5_xbar$LCL,dQ5_xbar$UCL),
slide_above_below=case_when(
xbar>=mean_observed ~ 1,
xbar<mean_observed ~ -1
),
moving_ten_sum= abs(slide_sum(x = slide_above_below,  before = 10L, step=1L)),
highlight_true=if_else(moving_ten_sum>10, TRUE, FALSE),
colour_def= case_when(
highlight_true==TRUE ~ 'blue',
xbar=!between(xbar, dQ5_xbar$LCL, dQ5_xbar$UCL) ~ 'blue',
xbar=between(xbar, dQ5_xbar$LCL, dQ5_xbar$UCL) ~ 'black'
))
ggplot(data=highlight, aes(x=timepoint)) +
geom_line(color=colour_def, aes(y=xbar),linetype="dotted")+
geom_line(color="red", aes(x=timepoint, y=dQ5_xbar$LCL))+
geom_line(color="red", aes(x=timepoint, y=dQ5_xbar$UCL))+
geom_point(aes(colour=highlight_true))+
labs(title = "Lineplot of Average xbar vs Timepoint for factory f1",
subtitle = "LCL and UCL values in red and average xbar value in black",
y="Xbar value",x="Timepoint") +
ggthemes::theme_economist_white(base_size = 11, base_family = "sans",
gray_bg = TRUE, horizontal = TRUE)
highlight<-spc_data_f1 %>%
ungroup() %>%
mutate(is_between=between(xbar,dQ5_xbar$LCL,dQ5_xbar$UCL),
slide_above_below=case_when(
xbar>=mean_observed ~ 1,
xbar<mean_observed ~ -1
),
moving_ten_sum= abs(slide_sum(x = slide_above_below,  before = 10L, step=1L)),
highlight_true=if_else(moving_ten_sum>10, TRUE, FALSE),
colour_def= case_when(
highlight_true==TRUE ~ 'blue',
xbar=!between(xbar, dQ5_xbar$LCL, dQ5_xbar$UCL) ~ 'blue',
xbar=between(xbar, dQ5_xbar$LCL, dQ5_xbar$UCL) ~ 'black'
))
ggplot(data=highlight, aes(x=timepoint)) +
geom_line(color=colour_def, aes(y=xbar),linetype="dotted")+
geom_line(color="red", aes(x=timepoint, y=dQ5_xbar$LCL))+
geom_line(color="red", aes(x=timepoint, y=dQ5_xbar$UCL))+
geom_point(aes(colour=highlight_true))+
labs(title = "Lineplot of Average xbar vs Timepoint for factory f1",
subtitle = "LCL and UCL values in red and average xbar value in black",
y="Xbar value",x="Timepoint") +
ggthemes::theme_economist_white(base_size = 11, base_family = "sans",
gray_bg = TRUE, horizontal = TRUE)
ggplot(data=highlight, aes(x=timepoint)) +
geom_line(color="colour_def", aes(y=xbar),linetype="dotted")+
geom_line(color="red", aes(x=timepoint, y=dQ5_xbar$LCL))+
geom_line(color="red", aes(x=timepoint, y=dQ5_xbar$UCL))+
geom_point(aes(colour=highlight_true))+
labs(title = "Lineplot of Average xbar vs Timepoint for factory f1",
subtitle = "LCL and UCL values in red and average xbar value in black",
y="Xbar value",x="Timepoint") +
ggthemes::theme_economist_white(base_size = 11, base_family = "sans",
gray_bg = TRUE, horizontal = TRUE)
ggplot(data=highlight, aes(x=timepoint)) +
#geom_line(color="colour_def", aes(y=xbar),linetype="dotted")+
geom_line(color="red", aes(x=timepoint, y=dQ5_xbar$LCL))+
geom_line(color="red", aes(x=timepoint, y=dQ5_xbar$UCL))+
geom_point(aes(colour=highlight_true))+
labs(title = "Lineplot of Average xbar vs Timepoint for factory f1",
subtitle = "LCL and UCL values in red and average xbar value in black",
y="Xbar value",x="Timepoint") +
ggthemes::theme_economist_white(base_size = 11, base_family = "sans",
gray_bg = TRUE, horizontal = TRUE)
ggplot(data=highlight, aes(x=timepoint)) +
geom_line(color="black", aes(y=xbar),linetype="dotted")+
geom_line(color="red", aes(x=timepoint, y=dQ5_xbar$LCL))+
geom_line(color="red", aes(x=timepoint, y=dQ5_xbar$UCL))+
geom_point(aes(colour=highlight_true))+
labs(title = "Lineplot of Average xbar vs Timepoint for factory f1",
subtitle = "LCL and UCL values in red and average xbar value in black",
y="Xbar value",x="Timepoint") +
ggthemes::theme_economist_white(base_size = 11, base_family = "sans",
gray_bg = TRUE, horizontal = TRUE)
ggplot(data=highlight, aes(x=timepoint)) +
geom_point(color="colour_def", aes(y=xbar),linetype="dotted")+
geom_line(color="red", aes(x=timepoint, y=dQ5_xbar$LCL))+
geom_line(color="red", aes(x=timepoint, y=dQ5_xbar$UCL))+
labs(title = "Lineplot of Average xbar vs Timepoint for factory f1",
subtitle = "LCL and UCL values in red and average xbar value in black",
y="Xbar value",x="Timepoint") +
ggthemes::theme_economist_white(base_size = 11, base_family = "sans",
gray_bg = TRUE, horizontal = TRUE)
ggplot(data=highlight, aes(x=timepoint)) +
geom_point(color=colour_def, aes(y=xbar),linetype="dotted")+
geom_line(color="red", aes(x=timepoint, y=dQ5_xbar$LCL))+
geom_line(color="red", aes(x=timepoint, y=dQ5_xbar$UCL))+
labs(title = "Lineplot of Average xbar vs Timepoint for factory f1",
subtitle = "LCL and UCL values in red and average xbar value in black",
y="Xbar value",x="Timepoint") +
ggthemes::theme_economist_white(base_size = 11, base_family = "sans",
gray_bg = TRUE, horizontal = TRUE)
ggplot(data=highlight, aes(x=timepoint)) +
geom_point(color=c(colour_def), aes(y=xbar),linetype="dotted")+
geom_line(color="red", aes(x=timepoint, y=dQ5_xbar$LCL))+
geom_line(color="red", aes(x=timepoint, y=dQ5_xbar$UCL))+
labs(title = "Lineplot of Average xbar vs Timepoint for factory f1",
subtitle = "LCL and UCL values in red and average xbar value in black",
y="Xbar value",x="Timepoint") +
ggthemes::theme_economist_white(base_size = 11, base_family = "sans",
gray_bg = TRUE, horizontal = TRUE)
ggplot(data=highlight, aes(x=timepoint)) +
geom_point(aes(y=xbar, color=colour_def),linetype="dotted")+
geom_line(color="red", aes(x=timepoint, y=dQ5_xbar$LCL))+
geom_line(color="red", aes(x=timepoint, y=dQ5_xbar$UCL))+
labs(title = "Lineplot of Average xbar vs Timepoint for factory f1",
subtitle = "LCL and UCL values in red and average xbar value in black",
y="Xbar value",x="Timepoint") +
ggthemes::theme_economist_white(base_size = 11, base_family = "sans",
gray_bg = TRUE, horizontal = TRUE)
highlight<-spc_data_f1 %>%
ungroup() %>%
mutate(is_between=between(xbar,dQ5_xbar$LCL,dQ5_xbar$UCL),
slide_above_below=case_when(
xbar>=mean_observed ~ 1,
xbar<mean_observed ~ -1
),
moving_ten_sum= abs(slide_sum(x = slide_above_below,  before = 10L, step=1L)),
highlight_true=if_else(moving_ten_sum>10, TRUE, FALSE),
colour_def= case_when(
highlight_true==TRUE ~ 'blue',
xbar=!between(xbar, dQ5_xbar$LCL, dQ5_xbar$UCL) ~ 'blue',
~ 'black'
))
highlight<-spc_data_f1 %>%
ungroup() %>%
mutate(is_between=between(xbar,dQ5_xbar$LCL,dQ5_xbar$UCL),
slide_above_below=case_when(
xbar>=mean_observed ~ 1,
xbar<mean_observed ~ -1
),
moving_ten_sum= abs(slide_sum(x = slide_above_below,  before = 10L, step=1L)),
highlight_true=if_else(moving_ten_sum>10, TRUE, FALSE),
colour_def= case_when(
highlight_true==TRUE ~ 'blue',
xbar=!between(xbar, dQ5_xbar$LCL, dQ5_xbar$UCL) ~ 'blue',
TRUE ~ 'black'
))
ggplot(data=highlight, aes(x=timepoint)) +
geom_point(aes(y=xbar, color=colour_def),linetype="dotted")+
geom_line(color="red", aes(x=timepoint, y=dQ5_xbar$LCL))+
geom_line(color="red", aes(x=timepoint, y=dQ5_xbar$UCL))+
labs(title = "Lineplot of Average xbar vs Timepoint for factory f1",
subtitle = "LCL and UCL values in red and average xbar value in black",
y="Xbar value",x="Timepoint") +
ggthemes::theme_economist_white(base_size = 11, base_family = "sans",
gray_bg = TRUE, horizontal = TRUE)
ggplot(data=highlight, aes(x=timepoint)) +
geom_point(aes(y=xbar, fill=colour_def),linetype="dotted")+
geom_line(color="red", aes(x=timepoint, y=dQ5_xbar$LCL))+
geom_line(color="red", aes(x=timepoint, y=dQ5_xbar$UCL))+
labs(title = "Lineplot of Average xbar vs Timepoint for factory f1",
subtitle = "LCL and UCL values in red and average xbar value in black",
y="Xbar value",x="Timepoint") +
ggthemes::theme_economist_white(base_size = 11, base_family = "sans",
gray_bg = TRUE, horizontal = TRUE)
ggplot(data=highlight, aes(x=timepoint)) +
geom_point(aes(y=xbar, color=colour_def),linetype="dotted")+
geom_line(color="red", aes(x=timepoint, y=dQ5_xbar$LCL))+
geom_line(color="red", aes(x=timepoint, y=dQ5_xbar$UCL))+
labs(title = "Lineplot of Average xbar vs Timepoint for factory f1",
subtitle = "LCL and UCL values in red and average xbar value in black",
y="Xbar value",x="Timepoint") +
ggthemes::theme_economist_white(base_size = 11, base_family = "sans",
gray_bg = TRUE, horizontal = TRUE)
ggplot(data=highlight, aes(x=timepoint)) +
geom_point(color=colour_def, aes(y=xbar),linetype="dotted")+
geom_line(color="red", aes(x=timepoint, y=dQ5_xbar$LCL))+
geom_line(color="red", aes(x=timepoint, y=dQ5_xbar$UCL))+
labs(title = "Lineplot of Average xbar vs Timepoint for factory f1",
subtitle = "LCL and UCL values in red and average xbar value in black",
y="Xbar value",x="Timepoint") +
ggthemes::theme_economist_white(base_size = 11, base_family = "sans",
gray_bg = TRUE, horizontal = TRUE)
ggplot(data=highlight, aes(x=timepoint)) +
geom_line(color=colour_def, aes(y=xbar),linetype="dotted")+
geom_line(color="red", aes(x=timepoint, y=dQ5_xbar$LCL))+
geom_line(color="red", aes(x=timepoint, y=dQ5_xbar$UCL))+
labs(title = "Lineplot of Average xbar vs Timepoint for factory f1",
subtitle = "LCL and UCL values in red and average xbar value in black",
y="Xbar value",x="Timepoint") +
ggthemes::theme_economist_white(base_size = 11, base_family = "sans",
gray_bg = TRUE, horizontal = TRUE)
,
ggplot(data=highlight, aes(x=timepoint)) +
geom_point(aes(y=xbar, color=colour_def),linetype="dotted")+
geom_line(color="red", aes(x=timepoint, y=dQ5_xbar$LCL))+
geom_line(color="red", aes(x=timepoint, y=dQ5_xbar$UCL))+
labs(title = "Lineplot of Average xbar vs Timepoint for factory f1",
subtitle = "LCL and UCL values in red and average xbar value in black",
y="Xbar value",x="Timepoint") +
ggthemes::theme_economist_white(base_size = 11, base_family = "sans",
gray_bg = TRUE, horizontal = TRUE)
spc_data_f2 <- dQ3_expected_f2 %>%
select(-factory) %>%
group_by(timepoint, week) %>%
summarise(xbar = mean(value),
Range = max(value) - min(value)) %>%
ungroup()
spc_data_f2_average_xbar_range <- spc_data_f2 %>%
summarise(Average_xbar = mean(xbar),
Average_Range = mean(Range))
dQ7<-spc_data_f2_average_xbar_range  %>%
mutate(LCL=Average_Range*XbarR_constants_week_n5$D3,
UCL=Average_Range*XbarR_constants_week_n5$D4)
ggplot(data = spc_data_f2, aes(x = timepoint)) +
geom_line(color = "red", aes(x = timepoint, y = dQ7$LCL)) +
geom_line(color = "red", aes(x = timepoint, y = dQ7$UCL)) +
geom_line(data = spc_data_f2,
color = "black",
aes(y = Range),
linetype = "dotted")+
labs(
title = "Lineplot of Range vs Timepoint for factory f2",
subtitle = "LCL and UCL values in red and average range value in black",
y = "Range values",
x = "Timepoint"
)
dQ7_xbar<-spc_data_f2_average_xbar_range   %>%
mutate(LCL=Average_xbar-Average_Range*XbarR_constants_week_n5$A2,
UCL=Average_xbar+Average_Range*XbarR_constants_week_n5$A2)
ggplot(data=spc_data_f2, aes(x=timepoint)) +
geom_line(color="black", aes(y=xbar),linetype="dotted")+
geom_line(color="red", aes(y=dQ7_xbar$LCL))+
geom_line(color="red", aes(y=dQ7_xbar$UCL))+
labs(title = "Lineplot of Average xbar vs Timepoint for factory f2",
subtitle = "LCL (red), UCL values (blue) and average xbar value in black",
y="Xbar value",x="Timepoint")
library(ggpomological)
ggplot(data = spc_data_f1, aes(x= week, y= xbar))+
geom_point() +
labs(title = "Scatterplot of xbar vs week for factory f1",
y="Xbar value",x="week") + theme_pomological_fancy()+
scale_color_pomological()
ggplot(data = spc_data_f2, aes(x= week, y= xbar))+
geom_point() +
labs(title = "Scatterplot of xbar vs week for factory f2",
y="Xbar value",x="week") + ggthemes::theme_fivethirtyeight()
pacman::p_load(
tidyverse,      # for data management and viz
slider,         # for calculating moving averages
tidyquant       # for calculating moving averages within ggplot
)
dQ8<-spc_data_f2 %>%
group_by(week) %>%
summarise(Average_Range=mean(Range, na.rm=T)) %>%
mutate(
MR_bar = slide_dbl(
Average_Range,
.f = ~mean(.x, na.rm = T),
.before = 1))
dQ8<-dQ8 %>%
mutate(Average_Average_Range=mean(Average_Range),
LCL= Average_Average_Range-2.66*MR_bar,
UCL=  Average_Average_Range+2.66*MR_bar)
ggplot(data=dQ8, aes(x=week)) +
geom_line(color="black", aes(y=Average_Range),linetype="dotted")+
geom_line(color="red", aes(y=LCL))+
geom_line(color="red", aes(y=UCL))+
labs(title = "Lineplot of Range vs Timepoint (by week) for factory f2",
subtitle = "LCL and UCL values in red and average range value in black",
y="Range values",x="week")
dQ8_xbar<-spc_data_f2 %>%
group_by(week) %>%
summarise(Average_xbar=mean(xbar, na.rm=T)) %>%
mutate(
MR_bar = slide_dbl(
Average_xbar,
.f = ~mean(.x, na.rm = T),
.before = 1))
dQ8_xbar<-dQ8_xbar %>%
mutate(Average_Average_xbar=mean(Average_xbar),
LCL= Average_Average_xbar-2.66*MR_bar,
UCL=  Average_Average_xbar+2.66*MR_bar)
ggplot(data=dQ8_xbar, aes(x=week)) +
geom_line(color="black", aes(y=Average_xbar),linetype="dotted")+
geom_line(color="red", aes(y=LCL))+
geom_line(color="red", aes(y=UCL))+
labs(title = "Lineplot of xbar  vs Timepoint (by week) for factory f2",
subtitle = "LCL and UCL values in red and average range value in black",
y="Range values",x="week")
knitr::opts_chunk$set(
echo = TRUE,
message = FALSE,
warning = FALSE
)
library(readr)
library(tidyverse)
library(dplyr)
library(readtext)
library(tidygraph)
library(ggraph)
library(igraph)
movies<-readtext("Movies.paj")
movies$text
start_nodes<-str_locate(movies$text,"\\*Vertices")
start_edge<-str_locate(movies$text,"\\*Edges")
end_nodes<-str_locate(movies$text,"\\*Arcs")
end_edge<-str_locate(movies$text,"\\*Partition")
nodes_data<-movies$text %>%
str_sub(start=start_nodes[1], end = end_nodes[1]-1) %>%
read_table( skip=1, col_names = F) %>%
map_df(str_trim) %>%
mutate(X2=str_extract(X2,"\\w+" ),
X7=str_extract(X3,"[A-Z]++[\\. ]" ),
full_name=str_c(X7, X2, sep=" "))
edges_data<-movies$text %>%
str_sub(start=start_edge[1], end = end_edge[1]-1) %>%
read_table( skip=1, col_names = F) %>%
rename(from=X1, to=X2)
# nodes_data_filtered<-nodes_data %>%
#   filter(X1 %in% c(edges_data$to,edges_data$from))
movies_network<-tbl_graph(nodes=nodes_data_filtered,
edges = edges_data,
directed = TRUE)
movies_network
movies_network<-tbl_graph(nodes=nodes_data,
edges = edges_data,
directed = TRUE)
movies_network
movies_network %>%
ggraph() +
geom_edge_link(colour = 'grey') +
geom_node_point(size = 2) +
theme_graph()
from_vect<-movies_network%>%
activate(edges) %>%
pull(from) %>%
unique()
movies_network<-movies_network %>%
activate(nodes) %>%
mutate(role=if_else(X1 %in% from_vect, "producer", "composer"))
movies_network %>%
ggraph() +
geom_edge_link(colour = 'grey') +
geom_node_point(aes(colour=role),size = 2) +
geom_node_text(aes(label = full_name), repel=TRUE)+theme_graph()
producers_edges <- edges_data %>%    #edges tibble
group_by(to) %>%    # grouping by composers
mutate(new_from = list(unique(from))) %>%   # cumulate all the unique froms this to is connected to
unnest_longer(new_from) %>%
filter(from != new_from) %>%
ungroup() %>%
select(to = from, from = new_from)
nodes_data_filtered<-nodes_data %>%
filter(X1 %in% c(producers_edges$to,producers_edges$from))
producers_network<-tbl_graph(nodes=nodes_data_filtered,
edges = producers_edges,
directed = FALSE)
producers_network  %>%
ggraph() +
geom_edge_link(colour = 'grey') +
geom_node_point(aes(colour='to')) +
geom_node_text(aes(label=X2, repel=TRUE))+theme_graph()
movies_network %>%
ggraph() +
geom_edge_link(colour = 'grey') +
geom_node_point(aes(colour=role),size = 2) +
geom_node_text(aes(label = full_name), repel=TRUE)+theme_graph()
producers_network  %>%
ggraph() +
geom_edge_link(colour = 'grey') +
geom_node_point(aes(colour='to')) +
geom_node_text(aes(label=X2, repel=TRUE))+theme_graph()
producers_network  %>%
ggraph() +
geom_edge_link(colour = 'grey') +
geom_node_point(aes(colour='to')) +
geom_node_text(aes(label=X2, repel=TRUE))+theme_graph() +
labs (title= 'Which producers worked with the same composer',
caption='data collected from 1960s and 1970s in Hollywood')
producers_network_clustered <-
producers_network %>%
activate(nodes) %>%
mutate(group = group_leading_eigen())
producers_network_clustered %>%
mutate(group = as.factor(group)) %>%
ggraph() +
geom_edge_link(colour = "grey") +
geom_node_point(aes(colour = group), size = 5) +
theme_graph()
producers_network_clustered
producers_network_clustered %>%
mutate(group = as.factor(group)) %>%
ggraph() +
geom_edge_link(colour = "grey") +
geom_node_point(aes(colour = group), size = 5) +
theme_graph()+
labs (title= 'Groups of producers working with the same composer',
subtitle='color represents different clusters of composers',
caption='data collected from 1960s and 1970s in Hollywood')
producers_network_clustered %>%
mutate(group = as.factor(group)) %>%
ggraph(layout='kk') +
geom_edge_link(colour = "grey") +
geom_node_point(aes(colour = group), size = 4) +
ggforce::geom_mark_hull(mapping = aes(x, y, group = group, fill = group),
concavity = 0.5,
expand = unit(4, 'mm'),
alpha = 0.25,
colour = 'white')+
rcartocolor::scale_fill_carto_d(palette = "Bold", guide = FALSE)+
theme_graph()
producers_network_clustered %>%
mutate(group = as.factor(group)) %>%
ggraph(layout='kk') +
geom_edge_link(colour = "grey") +
geom_node_point(aes(colour = group), size = 4) +
ggforce::geom_mark_hull(mapping = aes(x, y, group = group, fill = group),
concavity = 0.5,
expand = unit(4, 'mm'),
alpha = 0.25,
colour = 'white')+
rcartocolor::scale_fill_carto_d(palette = "Bold", guide = FALSE)+
theme_graph()+
labs (title= 'Groups of producers working with the same composer',
subtitle='color represents the area of different clustered groups',
caption='data collected from 1960s and 1970s in Hollywood')+
theme(legend.position="bottom")
