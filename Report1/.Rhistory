knitr::opts_chunk$set(echo = TRUE)
library(readr)
library(tidyverse)
library(dplyr)
cheese_data <- read_csv("Data/cheese_data.csv")
cheese_data_f1<-cheese_data %>%
filter(factory=="f1")
cheese_data_f2<-cheese_data %>%
filter(factory=="f2")
cheese_data_f1_filtered<-cheese_data_f1 %>%
mutate_all(na_if, 0)
cheese_data_f2_filtered<-cheese_data_f2 %>%
mutate_all(na_if, 0)
# table(is.na(cheese_data_f1_filtered))
#
# table(is.na(cheese_data_f2_filtered))
count_missing_f1<-sum(is.na(cheese_data_f1_filtered))
count_missing_f2<-sum(is.na(cheese_data_f2_filtered))
cheese_data_f1_NA_removed<-cheese_data_f1_filtered[rowSums(is.na(cheese_data_f1_filtered)) < 3, ]
cheese_data_f2_NA_removed<-cheese_data_f2_filtered[rowSums(is.na(cheese_data_f2_filtered)) < 3, ]
dQ3<-cheese_data_f1_filtered
dQ3_expected<-  dQ3[apply(dQ3[,1:4], 1, function(x) all(x > 65) & all(x < 15)),]
filter(cols=starts_with("m"))
View(cheese_data_f1_filtered)
dQ3_expected<-  dQ3[apply(dQ3[,4:8], 1, function(x) all(x > 65) & all(x < 15)),]
dQ3<-cheese_data_f1_filtered
dQ3_expected<-  dQ3[apply(dQ3[,4:8], 1, function(x) all(x > 65) & all(x < 15)),]
filter(cols=starts_with("m"))
dQ3_expected<-cheese_data_f1_filtered %>%
filter(cols=starts_with("m"))
(filter(cols==starts_with("m")> 65)
dQ3_expected<-cheese_data_f1_filtered %>%
(filter(cols==starts_with("m")) > 65)
dQ3_expected<-cheese_data_f1_filtered %>%
(filter(cols==starts_with(c("m"))) > 65)
dQ3_expected<-cheese_data_f1_filtered %>%
select(starts_with("m"))
View(dQ3_expected)
?filter_all
dQ3_expected<-cheese_data_f1_filtered %>%
select(starts_with("m")) %>%
filter_all(any_vars(.<65 ) & any_vars(.>15))
dQ3_expected<-cheese_data_f1_filtered %>%
select(starts_with("m")) %>%
filter_all(any_vars(.<65 ) & any_vars(.>15))
dQ3_expected<-cheese_data_f1_filtered %>%
select(starts_with("m")) %>%
filter_all(any_vars(.<65 ) || any_vars(.>15))
dQ3_expected<-cheese_data_f1_filtered %>%
select(starts_with("m")) %>%
filter_all(any_vars(.<65 ) | any_vars(.>15))
dQ3_expected<-cheese_data_f1_filtered %>%
select(starts_with("m")) %>%
filter_all(any_vars(.<65 ) || any_vars(.>15))
dQ3_expected<-cheese_data_f1_filtered %>%
select(starts_with("m")) %>%
#filter_all(any_vars(.<65 ) || any_vars(.>15))
filter_all(any_vars(.<65 ))
View(dQ3_expected)
dQ3_expected<-cheese_data_f1_filtered %>%
select(starts_with("m")) %>%
#filter_all(any_vars(.<65 ) || any_vars(.>15))
filter_all(any_vars(.<65 )) %>%
filter_all(any_vars(.>15))
View(cheese_data_f1_filtered)
dQ1<-cheese_data_f1_filtered
dQ1<-dQ1 %>%
mutate(m1=is.na(m1))
View(dQ1)
?across
dQ1<-dQ1 %>%
mutate(across(m1:m5,is.na))
View(dQ1)
dQ1<-dQ1 %>%
mutate(across(m1:m5,is.na)) %>%
mutate(total_na=m1+m2+m3+m4+m5)
dQ1<-cheese_data_f1_filtered
dQ1<-dQ1 %>%
mutate(across(m1:m5,is.na)) %>%
mutate(total_na=m1+m2+m3+m4+m5)
dQ1<-dQ1 %>%
mutate(across(m1:m5,is.na)) %>%
mutate(total_na=m1+m2+m3+m4+m5) %>%
filter(total_na>1)
dQ1<-cheese_data_f1_filtered %>%
mutate(across(m1:m5,is.na)) %>%
mutate(total_na=m1+m2+m3+m4+m5) %>%
filter(total_na>1)
?anti_join
dQ2<-cheese_data_f1_filtered %>%
anti_join(dQ1)
View(dQ2)
dQ1<-cheese_data_f1_filtered %>%
mutate(across(m1:m5,is.na)) %>%
mutate(total_na=m1+m2+m3+m4+m5) %>%
filter(total_na>1) %>%
select(factory, week, timepoint)
dQ2<-cheese_data_f1_filtered %>%
anti_join(dQ1)
cheese_data_f1_NA_removed<-cheese_data_f1_filtered[rowSums(is.na(cheese_data_f1_filtered)) < 2, ]
dQ3_expected<-cheese_data_f1_filtered %>%
pivot_longer(cols=m1:m5, names_to= "measurement_number" , values_to="value" )
View(dQ3_expected)
dQ3_expected<-cheese_data_f1_filtered %>%
pivot_longer(cols=m1:m5, names_to= "measurement_number" , values_to="value" ) %>%
filter(!between(value, 15, 65))
View(dQ3_expected)
dQ3_expected<-cheese_data_f1_filtered %>%
pivot_longer(cols=m1:m5, names_to= "measurement_number" , values_to="value" ) %>%
filter(between(value, 15, 65))
View(dQ3_expected)
knitr::opts_chunk$set(
echo = TRUE,
message = FALSE,
warning = FALSE
)
library(readr)
library(tidyverse)
library(dplyr)
spending <- read_csv("Data/IHME_DAH_DATABASE_1990_2019_Y2020M04D23.CSV") %>%
filter(year == 2019)
spending <- spending %>%
select(
source, channel, recipient_country,
contains(c("hiv", "mal", "tb", "ncd"))
)
spending_long <- spending %>%
pivot_longer(cols = contains(c("hiv", "mal", "tb", "ncd"))) %>%
mutate(disease = str_extract(name, "[^_]+")) %>%
group_by(source, disease) %>%
mutate(value = as.numeric(value)) %>%
mutate(expenditure = sum(value, na.rm = TRUE)) %>%
ungroup()
spending_hiv<-spending %>%
pivot_longer(cols = contains(c("hiv"))) %>%
mutate(disease = str_extract(name, "[^_]+")) %>%
group_by(source) %>%
mutate(value = as.numeric(value)) %>%
mutate(expenditure = sum(value, na.rm = TRUE)) %>%
ungroup()
View(spending_long)
View(spending)
spending <- read_csv("Data/IHME_DAH_DATABASE_1990_2019_Y2020M04D23.CSV") %>%
filter(year == 2018)
spending <- read_csv("Data/IHME_DAH_DATABASE_1990_2019_Y2020M04D23.CSV")
spending <- read_csv("Data/IHME_DAH_DATABASE_1990_2019_Y2020M04D23.CSV") %>%
filter(year == 2017)
knitr::opts_chunk$set(
echo = FALSE,
message = FALSE,
warning = FALSE
)
library(readr)
library(tidyverse)
library(dplyr)
library(janitor)
library(kableExtra)
cheese_data <- read_csv("Data/cheese_data.csv")
cheese_data_f1<-cheese_data %>%
filter(factory=="f1")
cheese_data_f2<-cheese_data %>%
filter(factory=="f2")
cheese_data_f1_filtered<-cheese_data_f1 %>%
mutate_all(na_if, 0)
cheese_data_f2_filtered<-cheese_data_f2 %>%
mutate_all(na_if, 0)
count_missing_f1<-sum(is.na(cheese_data_f1_filtered))
count_missing_f2<-sum(is.na(cheese_data_f2_filtered))
dQ1_f1<-cheese_data_f1_filtered %>%
mutate(across(m1:m5,is.na)) %>%
mutate(total_na=m1+m2+m3+m4+m5) %>%
filter(total_na>1) %>%
select(factory, week, timepoint)
dQ2_f1<-cheese_data_f1_filtered %>%
anti_join(dQ1_f1)
dQ2_replaced_f1<-dQ2_f1 %>%
pivot_longer(cols = m1:m5, names_to ="measurements", values_to ="value") %>%
group_by(timepoint) %>%
mutate(four_timepoint_mean = sum(value, na.rm = TRUE)/4) %>%
mutate(value=if_else(is.na(value), four_timepoint_mean, value)) %>%
select(-four_timepoint_mean)
dQ1_f2<-cheese_data_f2_filtered %>%
mutate(across(m1:m5,is.na)) %>%
mutate(total_na=m1+m2+m3+m4+m5) %>%
filter(total_na>1) %>%
select(factory, week, timepoint)
dQ2_f2<-cheese_data_f2_filtered %>%
anti_join(dQ1_f1)
dQ2_replaced_f2<-dQ2_f2 %>%
pivot_longer(cols = m1:m5, names_to ="measurements", values_to ="value") %>%
group_by(timepoint) %>%
mutate(four_timepoint_mean = sum(value, na.rm = TRUE)/4) %>%
mutate(value=if_else(is.na(value), four_timepoint_mean, value)) %>%
select(-four_timepoint_mean)
count_timepointmissing_f1<-dQ1_f1 %>%
count()
count_timepointmissing_f2<-dQ1_f2 %>%
count()
dQ3_expected_f1<-dQ2_replaced_f1 %>%
filter(between(value, 15, 65))
dQ3_f1_unexpected<-dQ2_replaced_f1 %>%
anti_join(dQ3_expected_f1) %>%
nrow()
dQ3_expected_f2<-dQ2_replaced_f2 %>%
filter(between(value, 15, 65))
dQ3_f2_unexpected<-dQ2_replaced_f2 %>%
anti_join(dQ3_expected_f2) %>%
nrow()
spc_data_f1<-dQ3_expected_f1 %>%
select(-factory) %>%
group_by(week,timepoint) %>%
summarize(xbar=mean(value),
Range=max(value)-min(value))
spc_data_f1_table<-spc_data_f1 %>%
#top_frac(n=10, wt="week") %>% # Cant'manage to demonstrate first 10  rows
kbl() %>%
kable_styling()
number_row_spc_data_f1<-spc_data_f1 %>%
nrow()
spc_data_f1_average_xbar_range<-spc_data_f1 %>%
summarize(Average_xbar=mean(xbar),
Average_Range=mean(Range))
spc_data_f1_average_xbar_range_table<-spc_data_f1_average_xbar_range %>%
kbl() %>%
kable_styling()
XbarR_constants <- read_csv("Data/XbarR_constants.csv") %>%
filter(n<26) %>%
rename(week=n) %>%
select(week,D3, D4)
XbarR_constants <-rbind(c(week = 1, D3 = 1, D4=1), XbarR_constants)
dQ5<-spc_data_f1_average_xbar_range %>%
left_join(XbarR_constants, by="week") %>%
mutate(LCL=Average_Range*D3,
UCL=Average_Range*D4)
ggplot(data=dQ5, aes(x=week)) +
geom_line(color="black", aes(y=Average_Range),linetype="dotted")+
geom_line(color="red", aes(y=LCL))+
geom_line(color="red", aes(y=UCL))+
labs(title = "Lineplot of Range vs Timepoint for factory f1",
subtitle = "LCL and UCL values in red and average range value in black",
y="Range values",x="Week number")
ggplot(data=dQ5, aes(x=time)) +
geom_line(color="black", aes(y=Average_Range),linetype="dotted")+
geom_line(color="red", aes(y=LCL))+
geom_line(color="red", aes(y=UCL))+
labs(title = "Lineplot of Range vs Timepoint for factory f1",
subtitle = "LCL and UCL values in red and average range value in black",
y="Range values",x="Week number")
ggplot(data=dQ5, aes(x=time))
View(dQ5)
XbarR_constants <- read_csv("Data/XbarR_constants.csv") %>%
filter(n<26) %>%
rename(week=n) %>%
select(week,D3, D4)
XbarR_constants <-rbind(c(week = 1, D3 = 1, D4=1), XbarR_constants)
dQ5<-spc_data_f1_average_xbar_range %>%
left_join(XbarR_constants, by="week") %>%
mutate(LCL=Average_Range*D3,
UCL=Average_Range*D4)
ggplot(data=dQ5, aes(x=week)) +
geom_line(color="black", aes(y=Average_Range),linetype="dotted")+
geom_line(color="red", aes(y=LCL))+
geom_line(color="red", aes(y=UCL))+
labs(title = "Lineplot of Range vs Timepoint for factory f1",
subtitle = "LCL and UCL values in red and average range value in black",
y="Range values",x="Week number")
# ggplot(data=dQ5, aes(x=time)) +
#   geom_line(color="black", aes(y=Average_Range),linetype="dotted")+
#   geom_line(color="red", aes(y=LCL))+
#   geom_line(color="red", aes(y=UCL))+
#   labs(title = "Lineplot of Range vs Timepoint for factory f1",
#        subtitle = "LCL and UCL values in red and average range value in black",
#        y="Range values",x="Week number")
XbarR_constants_xbar <- read_csv("Data/XbarR_constants.csv") %>%
filter(n<26) %>%
rename(week=n) %>%
select(week,A2)
XbarR_constants_xbar <-rbind(c(week = 1, A2=1), XbarR_constants_xbar )
dQ5_xbar<-spc_data_f1_average_xbar_range %>%
left_join(XbarR_constants_xbar, by="week") %>%
mutate(LCL=Average_xbar-Average_Range*A2,
UCL=Average_xbar+Average_Range*A2)
ggplot(data=dQ5_xbar, aes(x=week)) +
geom_line(color="black", aes(y=Average_xbar),linetype="dotted")+
geom_line(color="red", aes(y=LCL))+
geom_line(color="red", aes(y=UCL))+
labs(title = "Lineplot of Average xbar vs Timepoint for factory f1",
subtitle = "LCL and UCL values in red and average xbar value in black",
y="xbar value",x="Week number")
spc_data_f1<-dQ3_expected_f1 %>%
select(-factory, -week) %>%
group_by(timepoint) %>%
summarize(xbar=mean(value),
Range=max(value)-min(value))
View(spc_data_f1)
spc_data_f1_table<-spc_data_f1 %>%
#top_frac(n=10, wt="week") %>% # Cant'manage to demonstrate first 10  rows
kbl() %>%
kable_styling()
number_row_spc_data_f1<-spc_data_f1 %>%
nrow()
spc_data_f1_average_xbar_range<-spc_data_f1 %>%
summarize(Average_xbar=mean(xbar),
Average_Range=mean(Range))
View(spc_data_f1_average_xbar_range)
spc_data_f1_average_xbar_range_table<-spc_data_f1_average_xbar_range %>%
kbl() %>%
kable_styling()
View(spc_data_f1)
XbarR_constants <- read_csv("Data/XbarR_constants.csv")
View(XbarR_constants)
XbarR_constants <- read_csv("Data/XbarR_constants.csv")
View(XbarR_constants)
View(spc_data_f1)
spc_data_f1<-dQ3_expected_f1 %>%
select(-factory) %>%
group_by(timepoint) %>%
summarize(xbar=mean(value),
Range=max(value)-min(value))
View(spc_data_f1)
spc_data_f1<-dQ3_expected_f1 %>%
select(-factory) %>%
group_by(timepoint) %>%
summarize(xbar=mean(value),
Range=max(value)-min(value))
spc_data_f1<-dQ3_expected_f1 %>%
select(-factory) %>%
group_by(timepoint,week) %>%
summarize(xbar=mean(value),
Range=max(value)-min(value))
View(spc_data_f1)
spc_data_f1_table<-spc_data_f1 %>%
#top_frac(n=10, wt="week") %>% # Cant'manage to demonstrate first 10  rows
kbl() %>%
kable_styling()
number_row_spc_data_f1<-spc_data_f1 %>%
nrow()
spc_data_f1_average_xbar_range<-spc_data_f1 %>%
summarize(Average_xbar=mean(xbar),
Average_Range=mean(Range))
spc_data_f1_average_xbar_range_table<-spc_data_f1_average_xbar_range %>%
kbl() %>%
kable_styling()
XbarR_constants_week <- read_csv("Data/XbarR_constants.csv") %>%
filter(n<26) %>%
rename(week=n) %>%
select(week,D3, D4)
XbarR_constants_week <-rbind(c(week = 1, D3 = 1, D4=1), XbarR_constants_week)
View(XbarR_constants_week)
View(spc_data_f1_average_xbar_range)
View(spc_data_f1)
View(spc_data_f1_average_xbar_range)
spc_data_f1<-dQ3_expected_f1 %>%
select(-factory) %>%
group_by(timepoint,week) %>%
mutate(xbar=mean(value),
Range=max(value)-min(value))
spc_data_f1<-dQ3_expected_f1 %>%
select(-factory) %>%
group_by(timepoint,week) %>%
summarise(xbar=mean(value),
Range=max(value)-min(value))
spc_data_f1_table<-spc_data_f1 %>%
#top_frac(n=10, wt="week") %>% # Cant'manage to demonstrate first 10  rows
kbl() %>%
kable_styling()
number_row_spc_data_f1<-spc_data_f1 %>%
nrow()
spc_data_f1_average_xbar_range<-spc_data_f1 %>%
summarize(Average_xbar=mean(xbar),
Average_Range=mean(Range))
View(spc_data_f1)
View(spc_data_f1)
View(spc_data_f1_average_xbar_range)
View(spc_data_f1)
spc_data_f1_average_xbar_range<-spc_data_f1 %>%
group_by(week) %>%
summarize(Average_xbar=mean(xbar),
Average_Range=mean(Range))
View(spc_data_f1_average_xbar_range)
spc_data_f1_average_xbar_range<-spc_data_f1 %>%
group_by(week) %>%
mutate(Average_xbar=mean(xbar),
Average_Range=mean(Range))
View(spc_data_f1_average_xbar_range)
XbarR_constants_week <- read_csv("Data/XbarR_constants.csv") %>%
filter(n<26) %>%
rename(week=n) %>%
select(week,D3, D4)
XbarR_constants_week <-rbind(c(week = 1, D3 = 1, D4=1), XbarR_constants_week)
View(XbarR_constants_week)
XbarR_constants_week_timepoint <-rbind(c(week = 1, D3 = 1, D4=1), XbarR_constants_week) %>%
mutate(timepoint=week*[1:5])
vector<-c(1:5)
View(XbarR_constants_week)
