# roll_sum = RcppRoll::roll_sum(slide_above_below, 10, align = "right")
)
abs(spc_data_f1$slide_above_below)
abs(highlight$slide_above_below)
knitr::opts_chunk$set(
echo = TRUE,
message = FALSE,
warning = FALSE
)
knitr::opts_chunk$set(
echo = TRUE,
message = FALSE,
warning = FALSE
)
library(readr)
library(tidyverse)
library(dplyr)
library(readtext)
library(tidygraph)
library(ggraph)
library(igraph)
movies<-readtext("Movies.paj")
movies$text
start_nodes<-str_locate(movies$text,"\\*Vertices")
start_edge<-str_locate(movies$text,"\\*Edges")
end_nodes<-str_locate(movies$text,"\\*Arcs")
end_edge<-str_locate(movies$text,"\\*Partition")
nodes_data<-movies$text %>%
str_sub(start=start_nodes[1], end = end_nodes[1]-1) %>%
read_table( skip=1, col_names = F) %>%
map_df(str_trim)
edges_data<-movies$text %>%
str_sub(start=start_edge[1], end = end_edge[1]-1) %>%
read_table( skip=1, col_names = F)
movies_network<-tbl_graph(nodes=nodes_data,
edges = edges_data,
directed = TRUE)
movies_network_new<-movies_network %>%
activate(nodes) %>%
rename(node_id=X1)
movies_network_new
#
# movies_nodes <- str_sub(movies$text,"\\*Vertices") %>%
#   read_table( skip = 1, col_names = FALSE)
#
# movies <- system.file("data/", package = "readtext")
#
# movies<-read_graph("Movies.paj", format = "pajek")
#
# network::read.paj(Movies.paj, verbose = FALSE, debug = FALSE, edge.name = NULL, simplify = FALSE,time.format=c('pajekTiming','networkDynamic'))
movies_network
library(ggraph)
movies_network %>%
ggraph() +
geom_edge_link(colour = 'grey') +
geom_node_point(size = 5) +
theme_graph()
movies_network %>%
ggraph() +
geom_edge_link(colour = 'grey') +
geom_node_point(size = 2) +
theme_graph()
movies_network_grouped <-
movies_network %>%
activate(nodes) %>%
mutate(group = group_leading_eigen())
knitr::opts_chunk$set(
echo = FALSE,
message = FALSE,
warning = FALSE
)
library(readr)
library(tidyverse)
library(dplyr)
library(janitor)
library(kableExtra)
library(tidyr)
cheese_data <- read_csv("Data/cheese_data.csv")
cheese_data_f1<-cheese_data %>%
filter(factory=="f1")
cheese_data_f2<-cheese_data %>%
filter(factory=="f2")
cheese_data_f1_filtered<-cheese_data_f1 %>%
mutate_all(na_if, 0)
cheese_data_f2_filtered<-cheese_data_f2 %>%
mutate_all(na_if, 0)
count_missing_f1<-sum(is.na(cheese_data_f1_filtered))
count_missing_f2<-sum(is.na(cheese_data_f2_filtered))
dQ1_f1<-cheese_data_f1_filtered %>%
mutate(across(m1:m5,is.na)) %>%
mutate(total_na=m1+m2+m3+m4+m5) %>%
filter(total_na>1) %>%
select(factory, week, timepoint)
dQ2_f1<-cheese_data_f1_filtered %>%
anti_join(dQ1_f1)
dQ2_replaced_f1<-dQ2_f1 %>%
pivot_longer(cols = m1:m5, names_to ="measurements", values_to ="value") %>%
group_by(timepoint) %>%
mutate(four_timepoint_mean = sum(value, na.rm = TRUE)/4) %>%
mutate(value=if_else(is.na(value), four_timepoint_mean, value)) %>%
select(-four_timepoint_mean)
dQ1_f2<-cheese_data_f2_filtered %>%
mutate(across(m1:m5,is.na)) %>%
mutate(total_na=m1+m2+m3+m4+m5) %>%
filter(total_na>1) %>%
select(factory, week, timepoint)
dQ2_f2<-cheese_data_f2_filtered %>%
anti_join(dQ1_f1)
dQ2_replaced_f2<-dQ2_f2 %>%
pivot_longer(cols = m1:m5, names_to ="measurements", values_to ="value") %>%
group_by(timepoint) %>%
mutate(four_timepoint_mean = sum(value, na.rm = TRUE)/4) %>%
mutate(value=if_else(is.na(value), four_timepoint_mean, value)) %>%
select(-four_timepoint_mean)
count_timepointmissing_f1<-dQ1_f1 %>%
count()
count_timepointmissing_f2<-dQ1_f2 %>%
count()
dQ3_expected_f1<-dQ2_replaced_f1 %>%
filter(between(value, 15, 65))
dQ3_f1_unexpected<-dQ2_replaced_f1 %>%
anti_join(dQ3_expected_f1) %>%
nrow()
dQ3_expected_f2<-dQ2_replaced_f2 %>%
filter(between(value, 15, 65))
dQ3_f2_unexpected<-dQ2_replaced_f2 %>%
anti_join(dQ3_expected_f2) %>%
nrow()
spc_data_f1<-dQ3_expected_f1 %>%
select(-factory) %>%
group_by(timepoint,week) %>%
summarise(xbar=mean(value),
Range=max(value)-min(value))
spc_data_f1_table<-spc_data_f1 %>%
ungroup() %>%
slice_max(n=10, order_by = "week") %>%
#top_frac(n=10, wt="week") %>% # Cant'manage to demonstrate first 10  rows
kbl() %>%
kable_styling()
number_row_spc_data_f1<-spc_data_f1 %>%
nrow()
spc_data_f1_average_xbar_range <- spc_data_f1 %>%
ungroup() %>% #group_by(week) %>%
summarise(Average_xbar = mean(xbar),
Average_Range = mean(Range))
XbarR_constants_week_n5 <- read_csv("Data/XbarR_constants.csv") %>%
filter(n==5)
dQ5 <- spc_data_f1_average_xbar_range  %>%
mutate(
LCL = Average_Range * XbarR_constants_week_n5$D3,
UCL = Average_Range * XbarR_constants_week_n5$D4
)
ggplot(data=spc_data_f1, aes(x=timepoint)) +
geom_line(color="red", aes(x=timepoint, y=dQ5$LCL))+
geom_line(color="red", aes(x=timepoint, y=dQ5$UCL))+
geom_line(data=spc_data_f1, color="black", aes(y=Range),linetype="dotted")+
labs(title = "Lineplot of Range vs Timepoint for factory f1",
subtitle = "LCL and UCL values in red and average range value in black",
y="Range values",x="Timepoint")
dQ5_xbar<-spc_data_f1_average_xbar_range   %>%
mutate(LCL=Average_xbar-Average_Range*XbarR_constants_week_n5$A2,
UCL=Average_xbar+Average_Range*XbarR_constants_week_n5$A2)
ggplot(data=spc_data_f1, aes(x=timepoint)) +
geom_line(color="black", aes(y=xbar),linetype="dotted")+
geom_line(color="red", aes(x=timepoint, y=dQ5_xbar$LCL))+
geom_line(color="red", aes(x=timepoint, y=dQ5_xbar$UCL))+
labs(title = "Lineplot of Average xbar vs Timepoint for factory f1",
subtitle = "LCL and UCL values in red and average xbar value in black",
y="Xbar value",x="Timepoint") +
ggthemes::theme_economist_white(base_size = 11, base_family = "sans",
gray_bg = TRUE, horizontal = TRUE)
library(slider)
vec<-spc_data_f1 %>%
pull(xbar)
highlight<-spc_data_f1 %>%
mutate(is_between=between(xbar,50,52),
slide_above_below=case_when(
xbar>=51 ~ 1,
xbar<51 ~ -1
),
moving_ten_sum= slide_sum(x = abs(slide_above_below),  before = 9)
# roll_sum = RcppRoll::roll_sum(slide_above_below, 10, align = "right")
)
# mean_observed<-mean(vec)
#
# mean_ref_value <- function(x) all(x >= mean_observed)
# consec_10_values_high <- slide_lgl(.x = vec, .f = mean_ref_value, .before = 9, .complete = TRUE)
View(highlight)
highlight<-spc_data_f1 %>%
mutate(is_between=between(xbar,50,52),
slide_above_below=case_when(
xbar>=51 ~ 1,
xbar<51 ~ -1
),
moving_ten_sum= slide_sum(x = slide_above_below,  before = 9)
# roll_sum = RcppRoll::roll_sum(slide_above_below, 10, align = "right")
)
knitr::opts_chunk$set(
echo = TRUE,
message = FALSE,
warning = FALSE
)
library(readr)
library(tidyverse)
library(dplyr)
library(readtext)
library(tidygraph)
library(ggraph)
library(igraph)
movies<-readtext("Movies.paj")
movies$text
start_nodes<-str_locate(movies$text,"\\*Vertices")
start_edge<-str_locate(movies$text,"\\*Edges")
end_nodes<-str_locate(movies$text,"\\*Arcs")
end_edge<-str_locate(movies$text,"\\*Partition")
nodes_data<-movies$text %>%
str_sub(start=start_nodes[1], end = end_nodes[1]-1) %>%
read_table( skip=1, col_names = F) %>%
map_df(str_trim)
edges_data<-movies$text %>%
str_sub(start=start_edge[1], end = end_edge[1]-1) %>%
read_table( skip=1, col_names = F)
movies_network<-tbl_graph(nodes=nodes_data,
edges = edges_data,
directed = TRUE)
movies_network_new<-movies_network %>%
activate(nodes) %>%
rename(node_id=X1)
movies_network
library(ggraph)
movies_network %>%
ggraph() +
geom_edge_link(colour = 'grey') +
geom_node_point(size = 2) +
theme_graph()
movies_network_grouped <-
movies_network %>%
activate(nodes) %>%
mutate(group = group_leading_eigen())
View(nodes_data)
View(edges_data)
edges_data<-edges_date %>%
rename(from=X1, to=X2)
edges_data<-edges_data %>%
rename(from=X1, to=X2)
from_vect<-edges_data %>%
rename(from=X1, to=X2) %>%
pull(from)
from_vect<-edges_data %>%
rename(from=X1, to=X2) %>%
pull(from)
library(readr)
library(tidyverse)
library(dplyr)
library(readtext)
library(tidygraph)
library(ggraph)
library(igraph)
movies<-readtext("Movies.paj")
movies$text
start_nodes<-str_locate(movies$text,"\\*Vertices")
start_edge<-str_locate(movies$text,"\\*Edges")
end_nodes<-str_locate(movies$text,"\\*Arcs")
end_edge<-str_locate(movies$text,"\\*Partition")
nodes_data<-movies$text %>%
str_sub(start=start_nodes[1], end = end_nodes[1]-1) %>%
read_table( skip=1, col_names = F) %>%
map_df(str_trim)
edges_data<-movies$text %>%
str_sub(start=start_edge[1], end = end_edge[1]-1) %>%
read_table( skip=1, col_names = F)
movies_network<-tbl_graph(nodes=nodes_data,
edges = edges_data,
directed = TRUE)
movies_network_new<-movies_network %>%
activate(nodes) %>%
rename(node_id=X1)
movies_network
library(ggraph)
movies_network %>%
ggraph() +
geom_edge_link(colour = 'grey') +
geom_node_point(size = 2) +
theme_graph()
movies_network_grouped <-
movies_network %>%
activate(nodes) %>%
mutate(group = group_leading_eigen())
from_vect<-edges_data %>%
rename(from=X1, to=X2) %>%
pull(from)
from_vect<-edges_data %>%
rename(from=X1, to=X2) %>%
pull(from) %>%
unique()
movies_network
#rename(from=X1, to=X2) %>%
pull(from) %>%
unique()
from_vect<-movies_network%>%
activate(edges) %>%
#rename(from=X1, to=X2) %>%
pull(from) %>%
unique()
movies_network %>%
ggraph(aes(color=role)) +
geom_edge_link(colour = 'grey') +
geom_node_point(size = 2) +
theme_graph()
movies_network<-movies_network %>%
activate(nodes) %>%
mutate(role=if_else(X1 %in% from_vect, "producer", "composer"))
movies_network %>%
ggraph(aes(color=role)) +
geom_edge_link(colour = 'grey') +
geom_node_point(size = 2) +
theme_graph()
movies_network %>%
ggraph(aes(colour=role)) +
geom_edge_link(colour = 'grey') +
geom_node_point(size = 2) +
theme_graph()
movies_network %>%
ggraph() +
geom_edge_link(colour = 'grey') +
geom_node_point(size = 2) +
theme_graph()
movies_network %>%
ggraph() +
geom_edge_link(colour = 'grey') +
geom_node_point(aes(colour=role),size = 2) +
theme_graph()
View(edges_data)
View(edges_data)
producers_edges <- edges_data %>%    #edges tibble
rename(from = X1, to = X2) %>%
group_by(to) %>%    # grouping by composers
mutate(new_from = list(unique(from))) %>%   # cumulate all the unique froms this to is connected to
unnest_longer(new_from) %>%
filter(from != new_from) %>%
ungroup() %>%
select(to = from, from = new_from)
producers_edges <- edges_data %>%    #edges tibble
rename(from = X1, to = X2) %>%
group_by(to) %>%    # grouping by composers
mutate(new_from = list(unique(from)))
View(producers_edges)
producers_edges <- edges_data %>%    #edges tibble
rename(from = X1, to = X2) %>%
group_by(to) %>%    # grouping by composers
mutate(new_from = list(unique(from))) %>%   # cumulate all the unique froms this to is connected to
unnest_longer(new_from)
View(producers_edges)
movies_network_grouped <-
movies_network %>%
activate(nodes) %>%
mutate(group = group_leading_eigen())
View(nodes_data)
View(edges_data)
edges_data<-movies$text %>%
str_sub(start=start_edge[1], end = end_edge[1]-1) %>%
read_table( skip=1, col_names = F) %>%
rename(from=X1, to=X2)
nodes_data<-movies$text %>%
str_sub(start=start_nodes[1], end = end_nodes[1]-1) %>%
read_table( skip=1, col_names = F) %>%
map_df(str_trim) %>%
mutate(X7=str_extract(X2,"\D+" ))
nodes_data<-movies$text %>%
str_sub(start=start_nodes[1], end = end_nodes[1]-1) %>%
read_table( skip=1, col_names = F) %>%
map_df(str_trim) %>%
mutate(X7=str_extract(X2,"\\D+" ))
nodes_data<-movies$text %>%
str_sub(start=start_nodes[1], end = end_nodes[1]-1) %>%
read_table( skip=1, col_names = F) %>%
map_df(str_trim) %>%
mutate(X7=str_extract(X2,"\\w+" ))
nodes_data<-movies$text %>%
str_sub(start=start_nodes[1], end = end_nodes[1]-1) %>%
read_table( skip=1, col_names = F) %>%
map_df(str_trim) %>%
mutate(X2=str_extract(X2,"\\w+" ))
nodes_data<-movies$text %>%
str_sub(start=start_nodes[1], end = end_nodes[1]-1) %>%
read_table( skip=1, col_names = F) %>%
map_df(str_trim) %>%
mutate(X2=str_extract(X2,"\\w+" ),
X3=str_extract(X3,"\\w+" ))
nodes_data<-movies$text %>%
str_sub(start=start_nodes[1], end = end_nodes[1]-1) %>%
read_table( skip=1, col_names = F) %>%
map_df(str_trim)
nodes_data<-movies$text %>%
str_sub(start=start_nodes[1], end = end_nodes[1]-1) %>%
read_table( skip=1, col_names = F) %>%
map_df(str_trim) %>%
mutate(X2=str_extract(X2,"\\w+" ),
X7=str_extract(X3,"\\w+" ))
nodes_data<-movies$text %>%
str_sub(start=start_nodes[1], end = end_nodes[1]-1) %>%
read_table( skip=1, col_names = F) %>%
map_df(str_trim) %>%
mutate(X2=str_extract(X2,"\\w+" ),
X7=str_extract(X3,"\\w \\. \\w" ))
nodes_data<-movies$text %>%
str_sub(start=start_nodes[1], end = end_nodes[1]-1) %>%
read_table( skip=1, col_names = F) %>%
map_df(str_trim) %>%
mutate(X2=str_extract(X2,"\\w+" ),
X7=str_extract(X3,"\\w\\.\\w" ))
nodes_data<-movies$text %>%
str_sub(start=start_nodes[1], end = end_nodes[1]-1) %>%
read_table( skip=1, col_names = F) %>%
map_df(str_trim) %>%
mutate(X2=str_extract(X2,"\\w+" ),
X7=str_extract(X3,"[A-Z]+[\\. ]" ))
nodes_data<-movies$text %>%
str_sub(start=start_nodes[1], end = end_nodes[1]-1) %>%
read_table( skip=1, col_names = F) %>%
map_df(str_trim) %>%
mutate(X2=str_extract(X2,"\\w+" ),
X7=str_extract(X3,"[A-Z]++[\\. ]" ))
nodes_data<-movies$text %>%
str_sub(start=start_nodes[1], end = end_nodes[1]-1) %>%
read_table( skip=1, col_names = F) %>%
map_df(str_trim) %>%
mutate(X2=str_extract(X2,"\\w+" ),
X7=str_extract(X3,"[A-Z]++[\\. ]" ),
full_name=str_c(X2, X7, sep=""))
nodes_data<-movies$text %>%
str_sub(start=start_nodes[1], end = end_nodes[1]-1) %>%
read_table( skip=1, col_names = F) %>%
map_df(str_trim) %>%
mutate(X2=str_extract(X2,"\\w+" ),
X7=str_extract(X3,"[A-Z]++[\\. ]" ),
full_name=str_c(X7, X2, sep=""))
nodes_data<-movies$text %>%
str_sub(start=start_nodes[1], end = end_nodes[1]-1) %>%
read_table( skip=1, col_names = F) %>%
map_df(str_trim) %>%
mutate(X2=str_extract(X2,"\\w+" ),
X7=str_extract(X3,"[A-Z]++[\\. ]" ),
full_name=str_c(X7, X2, sep=" "))
from_vect<-movies_network%>%
activate(edges) %>%
#rename(from=X1, to=X2) %>%
pull(from) %>%
unique()
movies_network<-movies_network %>%
activate(nodes) %>%
mutate(role=if_else(X1 %in% from_vect, "producer", "composer"))
movies_network<-tbl_graph(nodes=nodes_data,
edges = edges_data,
directed = TRUE)
movies_network %>%
ggraph() +
geom_edge_link(colour = 'grey') +
geom_node_point(aes(colour=role),size = 2) +
theme_graph()
movies_network<-movies_network %>%
activate(nodes) %>%
mutate(role=if_else(X1 %in% from_vect, "producer", "composer"))
movies_network %>%
ggraph() +
geom_edge_link(colour = 'grey') +
geom_node_point(aes(colour=role),size = 2) +
theme_graph()
View(edges_data)
View(edges_data)
movies_network %>%
ggraph() +
geom_edge_link(colour = 'grey') +
geom_node_point(aes(colour=role),size = 2) +
theme_graph() +
geom_node_text(aes(label = full_name), repel=TRUE)
movies_network %>%
ggraph() +
geom_edge_link(colour = 'grey') +
geom_node_point(aes(colour=role),size = 2) +
theme_graph() +
geom_node_text(aes(label = full_name), repel=TRUE)
from_vect<-movies_network%>%
activate(edges) %>%
#rename(from=X1, to=X2) %>%
pull(from) %>%
unique()
movies_network<-movies_network %>%
activate(nodes) %>%
mutate(role=if_else(X1 %in% from_vect, "producer", "composer"))
movies_network %>%
ggraph() +
geom_edge_link(colour = 'grey') +
geom_node_point(aes(colour=role),size = 2) +
theme_graph() +
geom_node_text(aes(label = full_name), repel=TRUE)
movies_network
movies_network %>%
ggraph() +
geom_edge_link(colour = 'grey') +
geom_node_point(aes(colour=role),size = 2) +
geom_node_text(aes(label = full_name), repel=TRUE)+theme_graph()
movies_network %>%
ggraph() +
geom_edge_link(colour = 'grey') +
geom_node_point(aes(colour=role),size = 2) +
geom_node_text(aes(label = to), repel=TRUE)+theme_graph()
movies_network %>%
ggraph() +
geom_edge_link(colour = 'grey') +
geom_node_point(aes(colour=role),size = 2) +
geom_node_text(aes(label = full_name), repel=TRUE)+theme_graph()
